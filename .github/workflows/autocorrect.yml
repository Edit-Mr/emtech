name: AutoCorrect Fix and Push

on:
    push:
        branches:
            - main

jobs:
    autocorrect:
        runs-on: ubuntu-latest

        steps:
            # Checkout the repository
            - name: Checkout code
              uses: actions/checkout@v4

            # Install Node.js and Yarn
            - name: Set up Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: "20"

            # Install dependencies (including autocorrect-node)
            - name: Install dependencies
              run: |
                  corepack enable
                  yarn add autocorrect

            # Run autocorrect fix
            - name: Run autocorrect
              run: autocorrect --fix

            # Add changes excluding package.json
            - name: Add changes except package.json
              run: |
                  git config --global user.name "Edit-Mr"
                  git config --global user.email "info@elvismao.com"
                  git add .
                  git reset package.json

            # Commit and push changes
            - name: Commit and push changes
              run: |
                  git commit -m "AutoCorrect fix applied"
                  git push origin main
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
